<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <title>æ§åˆ¶å°</title>
    <link rel="stylesheet" href="static/css/common.css"/>
    <link rel="stylesheet" href="static/css/dashboard.css"/>
</head>
<body>
<div class="theme-toggle" id="themeToggle" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ™</div>

<header>
    <h1>æ¬¢è¿ï¼Œ<span id="userName">ç”¨æˆ·</span></h1>
    <button id="logoutBtn" class="btn secondary">é€€å‡ºç™»å½•</button>
</header>

<main>
    <section>
        <h2>æˆ‘çš„èµ„æ–™</h2>
        <p>ç”¨æˆ·åï¼š<span id="uname"></span></p>
        <p>é‚®ç®±ï¼š<span id="uemail"></span></p>
    </section>

    <section>
        <h2>å¿«é€Ÿæ“ä½œ</h2>
        <button class="btn">ä¿®æ”¹å¯†ç </button>
        <button class="btn secondary" id="delBtn">åˆ é™¤è´¦å·</button>
    </section>
</main>

<script type="module">
    /* è·¯ç”±å®ˆå« */
    const token = localStorage.getItem('token');
    const user  = JSON.parse(localStorage.getItem('user') || '{}');
    if (!token || !user.username) location.href = 'login.html';

    /* æ¸²æŸ“ç”¨æˆ·ä¿¡æ¯ */
    document.getElementById('userName').textContent = user.username;
    document.getElementById('uname').textContent    = user.username;
    document.getElementById('uemail').textContent   = user.email || 'æœªå¡«å†™';

    /* é€€å‡ºç™»å½• */
    document.getElementById('logoutBtn').addEventListener('click', () => {
        localStorage.removeItem('token');
        localStorage.removeItem('user');
        location.href = 'login.html';
    });

    /* ä¸»é¢˜åˆ‡æ¢ï¼ˆåŒ login.js é€»è¾‘ï¼‰ */
    const html   = document.documentElement;
    const toggle = document.getElementById('themeToggle');
    const saved  = localStorage.getItem('theme');
    if (saved === 'dark') {
        html.setAttribute('data-theme', 'dark');
        toggle.textContent = 'â˜€ï¸';
    }
    toggle.addEventListener('click', () => {
        const isDark = html.hasAttribute('data-theme');
        if (isDark) {
            html.removeAttribute('data-theme');
            toggle.textContent = 'ğŸŒ™';
            localStorage.setItem('theme', 'light');
        } else {
            html.setAttribute('data-theme', 'dark');
            toggle.textContent = 'â˜€ï¸';
            localStorage.setItem('theme', 'dark');
        }
    });
</script>
</body>
</html>